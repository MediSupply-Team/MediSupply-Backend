###############################################################################
# TEST ENDPOINTS - VENDEDOR Y PLAN DE VENTA
# Usar con REST Client (VS Code) o similar
###############################################################################

@baseUrl = http://localhost:8002
@catalogoUrl = http://localhost:8003

### Variables (actualizar después de crear catálogos)
@tipo_rol_id = replace-with-actual-id
@territorio_id = replace-with-actual-id
@tipo_plan_id = replace-with-actual-id
@region_id = replace-with-actual-id
@zona_id = replace-with-actual-id
@vendedor_id = replace-with-actual-id

###############################################################################
# PASO 1: CREAR CATÁLOGOS BASE
###############################################################################

### 1.1 Crear Tipo de Rol Vendedor
POST {{baseUrl}}/api/v1/catalogos/tipos-rol
Content-Type: application/json

{
  "codigo": "GERENTE_REG",
  "nombre": "Gerente Regional",
  "descripcion": "Gerente responsable de una región completa",
  "nivel_jerarquia": 1,
  "permisos": {
    "ver_reportes": true,
    "aprobar_descuentos": true,
    "gestionar_vendedores": true
  },
  "activo": true
}

### 1.2 Crear Territorio
POST {{baseUrl}}/api/v1/catalogos/territorios
Content-Type: application/json

{
  "codigo": "BOG-NORTE",
  "nombre": "Bogotá Norte",
  "pais": "CO",
  "descripcion": "Territorio norte de Bogotá",
  "activo": true
}

### 1.3 Crear Tipo de Plan
POST {{baseUrl}}/api/v1/catalogos/tipos-plan
Content-Type: application/json

{
  "codigo": "PLAN_PREMIUM",
  "nombre": "Plan Premium",
  "descripcion": "Plan con comisiones altas y metas agresivas",
  "comision_base_defecto": 10.0,
  "activo": true
}

### 1.4 Crear Región
POST {{baseUrl}}/api/v1/catalogos/regiones
Content-Type: application/json

{
  "codigo": "REG-CENTRAL",
  "nombre": "Región Central",
  "pais": "CO",
  "descripcion": "Región central del país",
  "activo": true
}

### 1.5 Crear Zona
POST {{baseUrl}}/api/v1/catalogos/zonas
Content-Type: application/json

{
  "codigo": "ZONA-NORTE-BOG",
  "nombre": "Zona Norte Bogotá",
  "tipo": "urbana",
  "descripcion": "Zona comercial norte de Bogotá",
  "activo": true
}

###############################################################################
# PASO 2: VERIFICAR CATÁLOGOS CREADOS
###############################################################################

### 2.1 Listar Tipos de Rol
GET {{baseUrl}}/api/v1/catalogos/tipos-rol?activo=true

### 2.2 Listar Territorios
GET {{baseUrl}}/api/v1/catalogos/territorios?pais=CO&activo=true

### 2.3 Listar Tipos de Plan
GET {{baseUrl}}/api/v1/catalogos/tipos-plan?activo=true

### 2.4 Listar Regiones
GET {{baseUrl}}/api/v1/catalogos/regiones?pais=CO&activo=true

### 2.5 Listar Zonas
GET {{baseUrl}}/api/v1/catalogos/zonas?tipo=urbana&activo=true

###############################################################################
# PASO 3: CREAR VENDEDOR CON PLAN COMPLETO
###############################################################################

### 3.1 Crear Vendedor con Plan de Venta
# NOTA: Actualizar los IDs de tipo_plan_id, rol_vendedor_id, territorio_id, region_ids, zona_ids
POST {{baseUrl}}/api/v1/vendedores
Content-Type: application/json

{
  "identificacion": "1234567890",
  "nombre_completo": "Juan Pérez Gómez",
  "email": "juan.perez@medisupply.com",
  "telefono": "+57-300-1234567",
  "pais": "CO",
  "username": "jperez",
  "rol": "seller",
  "rol_vendedor_id": "{{tipo_rol_id}}",
  "territorio_id": "{{territorio_id}}",
  "fecha_ingreso": "2024-01-15",
  "observaciones": "Vendedor con experiencia en sector hospitalario",
  "activo": true,
  "plan_venta": {
    "tipo_plan_id": "{{tipo_plan_id}}",
    "nombre_plan": "Plan Premium Q1 2024",
    "fecha_inicio": "2024-01-01",
    "fecha_fin": "2024-03-31",
    "meta_ventas": 150000.00,
    "comision_base": 8.0,
    "estructura_bonificaciones": {
      "70": 2,
      "90": 5,
      "100": 10
    },
    "observaciones": "Plan agresivo con bonificaciones escalonadas",
    "productos": [
      {
        "producto_id": "PROD001",
        "meta_cantidad": 100,
        "precio_unitario": 1500.00
      },
      {
        "producto_id": "PROD002",
        "meta_cantidad": 80,
        "precio_unitario": 2000.00
      }
    ],
    "region_ids": ["{{region_id}}"],
    "zona_ids": ["{{zona_id}}"]
  }
}

###############################################################################
# PASO 4: CONSULTAR VENDEDOR
###############################################################################

### 4.1 Listar Vendedores
GET {{baseUrl}}/api/v1/vendedores?page=1&size=50&activo=true

### 4.2 Obtener Vendedor Básico (con plan_venta_id)
GET {{baseUrl}}/api/v1/vendedores/{{vendedor_id}}

### 4.3 Obtener DETALLE COMPLETO del Vendedor (con plan completo)
GET {{baseUrl}}/api/v1/vendedores/{{vendedor_id}}/detalle

###############################################################################
# PASO 5: ACTUALIZAR VENDEDOR
###############################################################################

### 5.1 Actualizar Vendedor
PUT {{baseUrl}}/api/v1/vendedores/{{vendedor_id}}
Content-Type: application/json

{
  "telefono": "+57-311-9876543",
  "observaciones": "Vendedor ascendido a Senior - Excelente desempeño Q1",
  "activo": true
}

###############################################################################
# PASO 6: LISTAR CLIENTES DEL VENDEDOR
###############################################################################

### 6.1 Listar Clientes del Vendedor
GET {{baseUrl}}/api/v1/vendedores/{{vendedor_id}}/clientes

###############################################################################
# PASO 7: DESACTIVAR VENDEDOR (Soft Delete)
###############################################################################

### 7.1 Desactivar Vendedor
DELETE {{baseUrl}}/api/v1/vendedores/{{vendedor_id}}

###############################################################################
# VERIFICACIÓN: Health Check
###############################################################################

### Health Check Cliente Service
GET {{baseUrl}}/health

### Health Check Catalogo Service
GET {{catalogoUrl}}/health

